import{m as N,e as J,T as K,u as Q,a as U,b as V,c as Z,i as $,E as ee,B as te,d as re,f as ne}from"./events-e3cb66e2.esm-c4583822.js";import{t as me,_ as we,g as pe,h as Ee,j as be,k as ge,l as ye,n as xe,o as ze,p as Re,q as Ce,r as Le,s as je,v as He,w as Be,x as Oe,y as Te,z as ke,A as Se,C as Me,D as Fe,F as Ge,G as Ie,H as Ae}from"./events-e3cb66e2.esm-c4583822.js";import{r as n,j as c}from"./index-0b3ab4c1.js";function A(t,r){let s;return(...a)=>{window.clearTimeout(s),s=window.setTimeout(()=>t(...a),r)}}function oe({debounce:t,scroll:r,polyfill:s,offsetSize:a}={debounce:0,scroll:!1,offsetSize:!1}){const f=s||(typeof window>"u"?class{}:window.ResizeObserver);if(!f)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[u,g]=n.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),e=n.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:u,orientationHandler:null}),d=t?typeof t=="number"?t:t.scroll:null,m=t?typeof t=="number"?t:t.resize:null,w=n.useRef(!1);n.useEffect(()=>(w.current=!0,()=>void(w.current=!1)));const[C,y,l]=n.useMemo(()=>{const o=()=>{if(!e.current.element)return;const{left:j,top:H,width:B,height:z,bottom:O,right:T,x:k,y:E}=e.current.element.getBoundingClientRect(),i={left:j,top:H,width:B,height:z,bottom:O,right:T,x:k,y:E};e.current.element instanceof HTMLElement&&a&&(i.height=e.current.element.offsetHeight,i.width=e.current.element.offsetWidth),Object.freeze(i),w.current&&!ae(e.current.lastBounds,i)&&g(e.current.lastBounds=i)};return[o,m?A(o,m):o,d?A(o,d):o]},[g,a,d,m]);function p(){e.current.scrollContainers&&(e.current.scrollContainers.forEach(o=>o.removeEventListener("scroll",l,!0)),e.current.scrollContainers=null),e.current.resizeObserver&&(e.current.resizeObserver.disconnect(),e.current.resizeObserver=null),e.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",e.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",e.current.orientationHandler))}function x(){e.current.element&&(e.current.resizeObserver=new f(l),e.current.resizeObserver.observe(e.current.element),r&&e.current.scrollContainers&&e.current.scrollContainers.forEach(o=>o.addEventListener("scroll",l,{capture:!0,passive:!0})),e.current.orientationHandler=()=>{l()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",e.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",e.current.orientationHandler))}const L=o=>{!o||o===e.current.element||(p(),e.current.element=o,e.current.scrollContainers=P(o),x())};return ie(l,!!r),se(y),n.useEffect(()=>{p(),x()},[r,l,y]),n.useEffect(()=>p,[]),[L,u,C]}function se(t){n.useEffect(()=>{const r=t;return window.addEventListener("resize",r),()=>void window.removeEventListener("resize",r)},[t])}function ie(t,r){n.useEffect(()=>{if(r){const s=t;return window.addEventListener("scroll",s,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",s,!0)}},[t,r])}function P(t){const r=[];if(!t||t===document.body)return r;const{overflow:s,overflowX:a,overflowY:f}=window.getComputedStyle(t);return[s,a,f].some(u=>u==="auto"||u==="scroll")&&r.push(t),[...r,...P(t.parentElement)]}const ce=["x","y","top","bottom","left","right","width","height"],ae=(t,r)=>ce.every(s=>t[s]===r[s]);function le({ref:t,children:r,fallback:s,resize:a,style:f,gl:u,events:g=ne,eventSource:e,eventPrefix:d,shadows:m,linear:w,flat:C,legacy:y,orthographic:l,frameloop:p,dpr:x,performance:L,raycaster:o,camera:j,scene:H,onPointerMissed:B,onCreated:z,...O}){n.useMemo(()=>J(K),[]);const T=Q(),[k,E]=oe({scroll:!0,debounce:{scroll:50,resize:0},...a}),i=n.useRef(null),S=n.useRef(null);n.useImperativeHandle(t,()=>i.current);const M=U(B),[F,X]=n.useState(!1),[G,D]=n.useState(!1);if(F)throw F;if(G)throw G;const R=n.useRef(null);V(()=>{const b=i.current;if(E.width>0&&E.height>0&&b){R.current||(R.current=Z(b));async function Y(){await R.current.configure({gl:u,scene:H,events:g,shadows:m,linear:w,flat:C,legacy:y,orthographic:l,frameloop:p,dpr:x,performance:L,raycaster:o,camera:j,size:E,onPointerMissed:(...h)=>M.current==null?void 0:M.current(...h),onCreated:h=>{h.events.connect==null||h.events.connect(e?$(e)?e.current:e:S.current),d&&h.setEvents({compute:(I,v)=>{const _=I[d+"X"],q=I[d+"Y"];v.pointer.set(_/v.size.width*2-1,-(q/v.size.height)*2+1),v.raycaster.setFromCamera(v.pointer,v.camera)}}),z==null||z(h)}}),R.current.render(c.jsx(T,{children:c.jsx(ee,{set:D,children:c.jsx(n.Suspense,{fallback:c.jsx(te,{set:X}),children:r??null})})}))}Y()}}),n.useEffect(()=>{const b=i.current;if(b)return()=>re(b)},[]);const W=e?"none":"auto";return c.jsx("div",{ref:S,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:W,...f},...O,children:c.jsx("div",{ref:k,style:{width:"100%",height:"100%"},children:c.jsx("canvas",{ref:i,style:{display:"block"},children:s})})})}function fe(t){return c.jsx(N,{children:c.jsx(le,{...t})})}export{fe as Canvas,me as ReactThreeFiber,we as _roots,pe as act,Ee as addAfterEffect,be as addEffect,ge as addTail,ye as advance,xe as applyProps,ze as buildGraph,Re as context,Ce as createEvents,Le as createPortal,Z as createRoot,je as dispose,ne as events,J as extend,He as flushGlobalEffects,Be as flushSync,Oe as getRootState,Te as invalidate,ke as reconciler,re as unmountComponentAtNode,Se as useFrame,Me as useGraph,Fe as useInstanceHandle,Ge as useLoader,Ie as useStore,Ae as useThree};
//# sourceMappingURL=react-three-fiber.esm-e3b369b3.js.map
