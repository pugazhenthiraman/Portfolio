{"version":3,"file":"react-three-fiber.esm-e3b369b3.js","sources":["../../node_modules/react-use-measure/dist/index.js","../../node_modules/@react-three/fiber/dist/react-three-fiber.esm.js"],"sourcesContent":["import{useState as T,useRef as p,useEffect as u,useMemo as M}from\"react\";function g(n,t){let o;return(...i)=>{window.clearTimeout(o),o=window.setTimeout(()=>n(...i),t)}}function j({debounce:n,scroll:t,polyfill:o,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const a=o||(typeof window==\"undefined\"?class{}:window.ResizeObserver);if(!a)throw new Error(\"This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills\");const[c,h]=T({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),e=p({element:null,scrollContainers:null,resizeObserver:null,lastBounds:c,orientationHandler:null}),d=n?typeof n==\"number\"?n:n.scroll:null,f=n?typeof n==\"number\"?n:n.resize:null,w=p(!1);u(()=>(w.current=!0,()=>void(w.current=!1)));const[z,m,s]=M(()=>{const r=()=>{if(!e.current.element)return;const{left:y,top:C,width:H,height:O,bottom:S,right:x,x:B,y:R}=e.current.element.getBoundingClientRect(),l={left:y,top:C,width:H,height:O,bottom:S,right:x,x:B,y:R};e.current.element instanceof HTMLElement&&i&&(l.height=e.current.element.offsetHeight,l.width=e.current.element.offsetWidth),Object.freeze(l),w.current&&!D(e.current.lastBounds,l)&&h(e.current.lastBounds=l)};return[r,f?g(r,f):r,d?g(r,d):r]},[h,i,d,f]);function v(){e.current.scrollContainers&&(e.current.scrollContainers.forEach(r=>r.removeEventListener(\"scroll\",s,!0)),e.current.scrollContainers=null),e.current.resizeObserver&&(e.current.resizeObserver.disconnect(),e.current.resizeObserver=null),e.current.orientationHandler&&(\"orientation\"in screen&&\"removeEventListener\"in screen.orientation?screen.orientation.removeEventListener(\"change\",e.current.orientationHandler):\"onorientationchange\"in window&&window.removeEventListener(\"orientationchange\",e.current.orientationHandler))}function b(){e.current.element&&(e.current.resizeObserver=new a(s),e.current.resizeObserver.observe(e.current.element),t&&e.current.scrollContainers&&e.current.scrollContainers.forEach(r=>r.addEventListener(\"scroll\",s,{capture:!0,passive:!0})),e.current.orientationHandler=()=>{s()},\"orientation\"in screen&&\"addEventListener\"in screen.orientation?screen.orientation.addEventListener(\"change\",e.current.orientationHandler):\"onorientationchange\"in window&&window.addEventListener(\"orientationchange\",e.current.orientationHandler))}const L=r=>{!r||r===e.current.element||(v(),e.current.element=r,e.current.scrollContainers=E(r),b())};return X(s,!!t),W(m),u(()=>{v(),b()},[t,s,m]),u(()=>v,[]),[L,c,z]}function W(n){u(()=>{const t=n;return window.addEventListener(\"resize\",t),()=>void window.removeEventListener(\"resize\",t)},[n])}function X(n,t){u(()=>{if(t){const o=n;return window.addEventListener(\"scroll\",o,{capture:!0,passive:!0}),()=>void window.removeEventListener(\"scroll\",o,!0)}},[n,t])}function E(n){const t=[];if(!n||n===document.body)return t;const{overflow:o,overflowX:i,overflowY:a}=window.getComputedStyle(n);return[o,i,a].some(c=>c===\"auto\"||c===\"scroll\")&&t.push(n),[...t,...E(n.parentElement)]}const k=[\"x\",\"y\",\"top\",\"bottom\",\"left\",\"right\",\"width\",\"height\"],D=(n,t)=>k.every(o=>n[o]===t[o]);export{j as default};\n//# sourceMappingURL=index.js.map\n","import { e as extend, u as useBridge, a as useMutableCallback, b as useIsomorphicLayoutEffect, c as createRoot, i as isRef, E as ErrorBoundary, B as Block, d as unmountComponentAtNode, f as createPointerEvents } from './events-e3cb66e2.esm.js';\nexport { t as ReactThreeFiber, _ as _roots, x as act, k as addAfterEffect, j as addEffect, l as addTail, n as advance, s as applyProps, y as buildGraph, q as context, g as createEvents, o as createPortal, c as createRoot, w as dispose, f as events, e as extend, h as flushGlobalEffects, p as flushSync, v as getRootState, m as invalidate, r as reconciler, d as unmountComponentAtNode, D as useFrame, F as useGraph, z as useInstanceHandle, G as useLoader, A as useStore, C as useThree } from './events-e3cb66e2.esm.js';\nimport * as React from 'react';\nimport * as THREE from 'three';\nimport useMeasure from 'react-use-measure';\nimport { FiberProvider } from 'its-fine';\nimport { jsx } from 'react/jsx-runtime';\nimport 'react-reconciler/constants';\nimport 'zustand/traditional';\nimport 'suspend-react';\nimport 'react-reconciler';\nimport 'scheduler';\n\nfunction CanvasImpl({\n  ref,\n  children,\n  fallback,\n  resize,\n  style,\n  gl,\n  events = createPointerEvents,\n  eventSource,\n  eventPrefix,\n  shadows,\n  linear,\n  flat,\n  legacy,\n  orthographic,\n  frameloop,\n  dpr,\n  performance,\n  raycaster,\n  camera,\n  scene,\n  onPointerMissed,\n  onCreated,\n  ...props\n}) {\n  // Create a known catalogue of Threejs-native elements\n  // This will include the entire THREE namespace by default, users can extend\n  // their own elements by using the createRoot API instead\n  React.useMemo(() => extend(THREE), []);\n  const Bridge = useBridge();\n  const [containerRef, containerRect] = useMeasure({\n    scroll: true,\n    debounce: {\n      scroll: 50,\n      resize: 0\n    },\n    ...resize\n  });\n  const canvasRef = React.useRef(null);\n  const divRef = React.useRef(null);\n  React.useImperativeHandle(ref, () => canvasRef.current);\n  const handlePointerMissed = useMutableCallback(onPointerMissed);\n  const [block, setBlock] = React.useState(false);\n  const [error, setError] = React.useState(false);\n\n  // Suspend this component if block is a promise (2nd run)\n  if (block) throw block;\n  // Throw exception outwards if anything within canvas throws\n  if (error) throw error;\n  const root = React.useRef(null);\n  useIsomorphicLayoutEffect(() => {\n    const canvas = canvasRef.current;\n    if (containerRect.width > 0 && containerRect.height > 0 && canvas) {\n      if (!root.current) root.current = createRoot(canvas);\n      async function run() {\n        await root.current.configure({\n          gl,\n          scene,\n          events,\n          shadows,\n          linear,\n          flat,\n          legacy,\n          orthographic,\n          frameloop,\n          dpr,\n          performance,\n          raycaster,\n          camera,\n          size: containerRect,\n          // Pass mutable reference to onPointerMissed so it's free to update\n          onPointerMissed: (...args) => handlePointerMissed.current == null ? void 0 : handlePointerMissed.current(...args),\n          onCreated: state => {\n            // Connect to event source\n            state.events.connect == null ? void 0 : state.events.connect(eventSource ? isRef(eventSource) ? eventSource.current : eventSource : divRef.current);\n            // Set up compute function\n            if (eventPrefix) {\n              state.setEvents({\n                compute: (event, state) => {\n                  const x = event[eventPrefix + 'X'];\n                  const y = event[eventPrefix + 'Y'];\n                  state.pointer.set(x / state.size.width * 2 - 1, -(y / state.size.height) * 2 + 1);\n                  state.raycaster.setFromCamera(state.pointer, state.camera);\n                }\n              });\n            }\n            // Call onCreated callback\n            onCreated == null ? void 0 : onCreated(state);\n          }\n        });\n        root.current.render( /*#__PURE__*/jsx(Bridge, {\n          children: /*#__PURE__*/jsx(ErrorBoundary, {\n            set: setError,\n            children: /*#__PURE__*/jsx(React.Suspense, {\n              fallback: /*#__PURE__*/jsx(Block, {\n                set: setBlock\n              }),\n              children: children != null ? children : null\n            })\n          })\n        }));\n      }\n      run();\n    }\n  });\n  React.useEffect(() => {\n    const canvas = canvasRef.current;\n    if (canvas) return () => unmountComponentAtNode(canvas);\n  }, []);\n\n  // When the event source is not this div, we need to set pointer-events to none\n  // Or else the canvas will block events from reaching the event source\n  const pointerEvents = eventSource ? 'none' : 'auto';\n  return /*#__PURE__*/jsx(\"div\", {\n    ref: divRef,\n    style: {\n      position: 'relative',\n      width: '100%',\n      height: '100%',\n      overflow: 'hidden',\n      pointerEvents,\n      ...style\n    },\n    ...props,\n    children: /*#__PURE__*/jsx(\"div\", {\n      ref: containerRef,\n      style: {\n        width: '100%',\n        height: '100%'\n      },\n      children: /*#__PURE__*/jsx(\"canvas\", {\n        ref: canvasRef,\n        style: {\n          display: 'block'\n        },\n        children: fallback\n      })\n    })\n  });\n}\n\n/**\r\n * A DOM canvas which accepts threejs elements as children.\r\n * @see https://docs.pmnd.rs/react-three-fiber/api/canvas\r\n */\nfunction Canvas(props) {\n  return /*#__PURE__*/jsx(FiberProvider, {\n    children: /*#__PURE__*/jsx(CanvasImpl, {\n      ...props\n    })\n  });\n}\n\nexport { Canvas };\n"],"names":["g","n","t","o","i","j","a","c","h","T","p","f","u","z","m","s","M","r","y","C","H","O","S","x","B","R","l","D","v","b","E","X","W","k","CanvasImpl","ref","children","fallback","resize","style","gl","events","createPointerEvents","eventSource","eventPrefix","shadows","linear","flat","legacy","orthographic","frameloop","dpr","performance","raycaster","camera","scene","onPointerMissed","onCreated","props","React.useMemo","extend","THREE","Bridge","useBridge","containerRef","containerRect","useMeasure","canvasRef","React.useRef","divRef","React.useImperativeHandle","handlePointerMissed","useMutableCallback","block","setBlock","React.useState","error","setError","root","useIsomorphicLayoutEffect","canvas","createRoot","run","args","state","isRef","event","jsx","ErrorBoundary","React.Suspense","Block","React.useEffect","unmountComponentAtNode","pointerEvents","Canvas","FiberProvider"],"mappings":"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","x_google_ignoreList":[0,1]}